<!DOCTYPE html>
<!-- Created by pdf2htmlEX (https://github.com/pdf2htmlEX/pdf2htmlEX) -->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pdf2htmlEX" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <style type="text/css">
        /*!
        * Base CSS for pdf2htmlEX
        * Copyright 2012,2013 Lu Wang <coolwanglu@gmail.com>
        * https://github.com/pdf2htmlEX/pdf2htmlEX/blob/master/share/LICENSE
        */
        #sidebar {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 250px;
            padding: 0;
            margin: 0;
            overflow: auto
        }

        #page-container {
            position: absolute;
            top: 0;
            left: 0;
            margin: 0;
            padding: 0;
            border: 0
        }

        @media screen {
            #sidebar.opened + #page-container {
                left: 250px
            }

            #page-container {
                bottom: 0;
                right: 0;
                overflow: auto
            }

            .loading-indicator {
                display: none
            }

                .loading-indicator.active {
                    display: block;
                    position: absolute;
                    width: 64px;
                    height: 64px;
                    top: 50%;
                    left: 50%;
                    margin-top: -32px;
                    margin-left: -32px
                }

                .loading-indicator img {
                    position: absolute;
                    top: 0;
                    left: 0;
                    bottom: 0;
                    right: 0
                }
        }


        .pf {
            position: relative;
            background-color: white;
            overflow: hidden;
            margin: 0;
            border: 0
        }

        .pc {
            position: absolute;
            border: 0;
            padding: 0;
            margin: 0;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: block;
            transform-origin: 0 0;
            -ms-transform-origin: 0 0;
            -webkit-transform-origin: 0 0
        }

            .pc.opened {
                display: block
            }

        .bf {
            position: absolute;
            border: 0;
            margin: 0;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            -ms-user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            user-select: none
        }

        .bi {
            position: absolute;
            border: 0;
            margin: 0;
            -ms-user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            user-select: none
        }


        .c {
            position: absolute;
            border: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
            display: block
        }

        .t {
            position: absolute;
            white-space: pre;
            font-size: 1px;
            transform-origin: 0 100%;
            -ms-transform-origin: 0 100%;
            -webkit-transform-origin: 0 100%;
            unicode-bidi: bidi-override;
            -moz-font-feature-settings: "liga" 0
        }

            .t:after {
                content: ''
            }

            .t:before {
                content: '';
                display: inline-block
            }

            .t span {
                position: relative;
                unicode-bidi: bidi-override
            }

        ._ {
            display: inline-block;
            color: transparent;
            z-index: -1
        }

        ::selection {
            background: rgba(127, 255, 255, 0.4)
        }

        ::-moz-selection {
            background: rgba(127, 255, 255, 0.4)
        }

        .pi {
            display: none
        }

        .d {
            position: absolute;
            transform-origin: 0 100%;
            -ms-transform-origin: 0 100%;
            -webkit-transform-origin: 0 100%
        }

        .it {
        }

        .ir:hover {
            cursor: pointer
        }
    </style>
    <style type="text/css">
        /*!
        * Fancy styles for pdf2htmlEX
        * Copyright 2012,2013 Lu Wang <coolwanglu@gmail.com>
        * https://github.com/pdf2htmlEX/pdf2htmlEX/blob/master/share/LICENSE
        */
        @keyframes fadein {
            from {
                opacity: 0
            }

            to {
                opacity: 1
            }
        }

        @-webkit-keyframes fadein {
            from {
                opacity: 0
            }

            to {
                opacity: 1
            }
        }



        @media screen {

            #outline {
                font-family: Georgia, Times, "Times New Roman", serif;
                font-size: 13px;
                margin: 2em 1em
            }

                #outline ul {
                    padding: 0
                }

                #outline li {
                    list-style-type: none;
                    margin: 1em 0
                }

                    #outline li > ul {
                        margin-left: 1em
                    }

                #outline a,
                #outline a:visited,
                #outline a:hover,
                #outline a:active {
                    line-height: 1.2;
                    color: #e8e8e8;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                    text-decoration: none;
                    display: block;
                    overflow: hidden;
                    outline: 0
                }

                    #outline a:hover {
                        color: #0cf
                    }

            #page-container {
                background-color: #9e9e9e;
                background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjUiPgo8cmVjdCB3aWR0aD0iNSIgaGVpZ2h0PSI1IiBmaWxsPSIjOWU5ZTllIj48L3JlY3Q+CjxwYXRoIGQ9Ik0wIDVMNSAwWk02IDRMNCA2Wk0tMSAxTDEgLTFaIiBzdHJva2U9IiM4ODgiIHN0cm9rZS13aWR0aD0iMSI+PC9wYXRoPgo8L3N2Zz4=");
                -webkit-transition: left 500ms;
                transition: left 500ms
            }



            .pc.opened {
                -webkit-animation: fadein 100ms;
                animation: fadein 100ms
            }

            .loading-indicator.active {
                -webkit-animation: swing 1.5s ease-in-out .01s infinite alternate none;
                animation: swing 1.5s ease-in-out .01s infinite alternate none
            }

            @media print {
                .btn_print img {
                    display: none;
                }

                thead {
                    display: table-header-group;
                }

                tfoot {
                    display: table-footer-group;
                }
            }
        }
    </style>
    <style type="text/css">
        @media print {
            .page {
                page-break-before: always; /* Bắt đầu trang mới trước div */
                page-break-inside: avoid; /* Tránh ngắt trang giữa div */
            }

            .pf {
                transform: scale(1.5);
                transform-origin: top left; /* Giữ nội dung bắt đầu từ góc trên cùng bên trái */
            }
        }

        .ff0 {
            font-family: sans-serif;
            visibility: hidden;
        }


        .ff1 {
            font-family: ff1;
            line-height: 1.106934;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }



        .ff2 {
            font-family: ff2;
            line-height: 1.383301;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }



        .ff3 {
            font-family: ff3;
            line-height: 1.106934;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }



        .ff4 {
            font-family: ff4;
            line-height: 1.346191;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }



        .ff5 {
            font-family: ff5;
            line-height: 1.330078;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }



        .ff6 {
            font-family: ff6;
            line-height: 1.106934;
            font-style: normal;
            font-weight: normal;
            visibility: visible;
        }

        .m0 {
            transform: matrix(0.250000, 0.000000, 0.000000, 0.250000, 0, 0);
            -ms-transform: matrix(0.250000, 0.000000, 0.000000, 0.250000, 0, 0);
            -webkit-transform: matrix(0.250000, 0.000000, 0.000000, 0.250000, 0, 0);
        }

        .v0 {
            vertical-align: 0.000000px;
        }

        .ls3 {
            letter-spacing: 0.000000px;
        }

        .ls1 {
            letter-spacing: 0.018224px;
        }

        .ls2 {
            letter-spacing: 0.037332px;
        }

        .ls0 {
            letter-spacing: 0.056464px;
        }

        .sc_ {
            text-shadow: none;
        }

        .sc0 {
            text-shadow: -0.015em 0 transparent, 0 0.015em transparent, 0.015em 0 transparent, 0 -0.015em transparent;
        }



        .ws0 {
            word-spacing: -10.999000px;
        }

        .ws1 {
            word-spacing: 0.000000px;
        }

        .fc2 {
            color: transparent;
        }

        .fc1 {
            color: rgb(30, 72, 124);
        }

        .fc0 {
            color: rgb(0, 0, 0);
        }

        .fs0 {
            font-size: 47.9952px; /* 39.996000 * 1.2 */
        }

        .fs1 {
            font-size: 57.5952px; /* 47.996000 * 1.2 */
        }

        .fs2 {
            font-size: 52.7952px; /* 43.996000 * 1.2 */
        }

        .fs3 {
            font-size: 62.3952px; /* 51.996000 * 1.2 */
        }

        .y0 {
            bottom: -0.500000px;
        }

        .y2e {
            bottom: 5.564000px;
        }

        .ye {
            bottom: 2.598000px;
        }

        .y29 {
            bottom: 2.804000px;
        }

        .y2c {
            bottom: 2.820000px;
        }

        .y2f {
            bottom: 4.924000px;
        }

        .y14 {
            bottom: 3.181000px;
        }

        .yc {
            bottom: 6.189000px;
        }

        .y16 {
            bottom: 3.197000px;
        }

        .y1c {
            bottom: 3.204000px;
        }

        .y10 {
            bottom: 3.205000px;
        }

        .y1e {
            bottom: 3.220000px;
        }

        .y12 {
            bottom: 6.221000px;
        }

        .y18 {
            bottom: 3.229000px;
        }

        .y28 {
            bottom: 3.236000px;
        }

        .y1a {
            bottom: 3.245000px;
        }

        .ya {
            bottom: 3.246000px;
        }

        .y2b {
            bottom: 5.252000px;
        }

        .y2 {
            bottom: 4.053000px;
        }

        .y4 {
            bottom: 4.069000px;
        }

        .y25 {
            bottom: 5.436000px;
        }

        .y8 {
            bottom: 10.574000px;
        }

        .y6 {
            bottom: 10.605000px;
        }

        .y24 {
            bottom: 20.628000px;
        }

        .y23 {
            bottom: 35.820000px;
        }

        .y26 {
            bottom: 50.196px;
        }

        .y22 {
            bottom: 47.988000px;
        }

        .y21 {
            bottom: 63.180000px;
        }

        .y20 {
            bottom: 75.348000px;
        }

        .y2d {
            bottom: 152.500000px;
        }

        .y2a {
            bottom: 219.628px;
        }

        .y27 {
            bottom: 244.636000px;
        }

        .y1f {
            bottom: 278.652000px;
        }

        .y1d {
            bottom: 384.764000px;
        }

        .y1b {
            bottom: 401.772000px;
        }

        .y19 {
            bottom: 435.787000px;
        }

        .y17 {
            bottom: 452.795000px;
        }

        .y15 {
            bottom: 486.811000px;
        }

        .y13 {
            bottom: 503.819000px;
        }

        .y11 {
            bottom: 537.835000px;
        }

        .yf {
            bottom: 554.843000px;
        }

        .yd {
            bottom: 588.858000px;
        }

        .yb {
            bottom: 623.187000px;
        }

        .y9 {
            bottom: 640.194000px;
        }

        .y7 {
            bottom: 657.202000px;
        }

        .y5 {
            bottom: 682.515000px;
        }

        .y3 {
            bottom: 724.835000px;
        }

        .y1 {
            bottom: 741.843000px;
        }

        .h2 {
            height: 20px;
        }

        .ha {
            height: 13.320000px;
        }

        .h5 {
            height: 21.312000px;
        }

        .h3 {
            height: 35.640967px;
        }

        .h8 {
            height: 39.205420px;
        }

        .h4 {
            height: 42.222340px;
        }

        .h6 {
            height: 42.769873px;
        }

        .hd {
            height: 45.027156px;
        }

        .h9 {
            height: 45.736076px;
        }

        .hc {
            height: 46.444996px;
        }

        .hb {
            height: 49.894279px;
        }

        .h7 {
            height: 50.667652px;
        }

        .hf {
            height: 54.890309px;
        }

        .he {
            height: 85.104000px;
        }

        .h0 {
            height: 841.890010px;
        }

        .h1 {
            height: 842.500000px;
        }

        .w4 {
            width: 250.772px;
        }

        .w3 {
            width: 292.945px;
        }

        .w2 {
            width: 489.89px;
        }

        .w0 {
            width: 595.276000px;
        }

        .w1 {
            width: 596.000000px;
        }

        .x0 {
            left: 0.000000px;
        }

        .x1 {
            left: 37.693px;
        }

        .xc {
            left: 67.314000px;
        }

        .xb {
            left: 75.483000px;
        }

        .xa {
            left: 79.482000px;
        }

        .x7 {
            left: 85.419000px;
        }

        .x9 {
            left: 92.043000px;
        }

        .x4 {
            left: 109.107000px;
        }

        .x3 {
            left: 111.555000px;
        }

        .x2 {
            left: 189.603000px;
        }

        .x8 {
            left: 299.638000px;
        }

        .x6 {
            left: 340.811px;
        }

        .x5 {
            left: 361.539000px;
        }

        @media print {
            .btn_print img {
                display: none;
            }

            thead {
                display: table-header-group;
            }

            tfoot {
                display: table-footer-group;
            }
        }

        .btn_print {
            left: 281px;
            top: 70px;
            position: absolute;
        }
    </style>
    <script type="text/javascript" src="ClientGlobalContext.js.aspx"></script>
    <script type="text/javascript" src="new_jquery2.0.3.min"></script>
    <script type="text/javascript" src="bsd_common.js"></script>
    <script type="text/javascript" src="bsd_CrmFetchKit.js"></script>
    <script type="text/javascript" src="bsd_entity_core.js"></script>
    <script type="text/javascript" src="bsd_execute.services.ultilities.js"></script>
    <script type="text/javascript" src="bsd_processingdialog.js"></script>
    <script type="text/javascript" src="new_modal.utilities.js"></script>
    <script type="text/javascript" src="bsd_CrmFetchKit.bundle.js"></script>
    <title></title>
</head>

<body>
    <div class="btn_print">
        <a id="icon_print" class="btn_print" onclick="window.print()" href="#" style="display:block">
            <img src="bsd_icon_print_handovernotices.png" width="120">
        </a>
    </div>
    <script>
        function formatNumberWithoutCurrencySymbol(amount, locale = 'vi-VN') {
            return new Intl.NumberFormat(locale, {
                minimumFractionDigits: 0, // Số chữ số thập phân tối thiểu
                maximumFractionDigits: 0  // Số chữ số thập phân tối đa
            }).format(amount);
        }
        function numberToTextVN(total) {
    try {
        let rs = "";
        total = Math.round(total);
        const ch = ["không", "một", "hai", "ba", "bốn", "năm", "sáu", "bảy", "tám", "chín"];
        const rch = ["lẻ", "mốt", "", "", "", "lăm"];
        const u = ["", "mươi", "trăm", "ngàn", "", "", "triệu", "", "", "tỷ", "", "", "ngàn", "", "", "triệu"];
        const nstr = total.toString();

        const n = Array.from(nstr).reverse().map(Number);
        const len = n.length;

        for (let i = len - 1; i >= 0; i--) {
            if (i % 3 === 2) { // số 0 ở hàng trăm
                if (n[i] === 0 && n[i - 1] === 0 && n[i - 2] === 0) continue;
            } else if (i % 3 === 1) { // số ở hàng chục
                if (n[i] === 0) {
                    if (n[i - 1] === 0) continue;
                    else {
                        rs += " " + rch[n[i]];
                        continue;
                    }
                }
                if (n[i] === 1) {
                    rs += " mười";
                    continue;
                }
            } else if (i !== len - 1) { // số ở hàng đơn vị (không phải là số đầu tiên)
                if (n[i] === 0) {
                    if (i + 2 <= len - 1 && n[i + 2] === 0 && n[i + 1] === 0) continue;
                    rs += " " + (i % 3 === 0 ? u[i] : u[i % 3]);
                    continue;
                }
                if (n[i] === 1) {
                    rs += " " + ((n[i + 1] === 1 || n[i + 1] === 0) ? ch[n[i]] : rch[n[i]]);
                    rs += " " + (i % 3 === 0 ? u[i] : u[i % 3]);
                    continue;
                }
                if (n[i] === 5) {
                    if (n[i + 1] !== 0) {
                        rs += " " + rch[n[i]];
                        rs += " " + (i % 3 === 0 ? u[i] : u[i % 3]);
                        continue;
                    }
                }
            }

            rs += (rs === "" ? " " : ", ") + ch[n[i]];
            rs += " " + (i % 3 === 0 ? u[i] : u[i % 3]);
        }

        // Thêm từ "đồng" vào cuối
        if (rs[rs.length - 1] !== ' ')
            rs += " đồng";
        else
            rs += "đồng";

        // Thêm từ "chẵn" nếu số chia hết cho 1.000
        if (total % 1000 === 0) {
            rs += " chẵn";
        }

        // Viết hoa chữ cái đầu tiên
        if (rs.length > 2) {
            let rs1 = rs.substring(0, 2).toUpperCase();
            rs = rs.substring(2);
            rs = rs1 + rs;
        }

        return rs.trim().replace(/lẻ,|mươi,|trăm,|mười,/g, match => match.slice(0, -1));
    } catch {
        return "";
    }
}

        var page = 1;
        function getCurrentDateFormatted() {
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0'); // Lấy ngày và thêm số 0 nếu cần
            const month = String(today.getMonth() + 1).padStart(2, '0'); // Lấy tháng (0-indexed) và thêm số 0 nếu cần
            const year = today.getFullYear(); // Lấy năm

            return `${day}`;
        }
        function getmonth() {
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0'); // Lấy ngày và thêm số 0 nếu cần
            const month = String(today.getMonth() + 1).padStart(2, '0'); // Lấy tháng (0-indexed) và thêm số 0 nếu cần
            const year = today.getFullYear(); // Lấy năm

            return `${month}`;
        }
        function getyear() {
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0'); // Lấy ngày và thêm số 0 nếu cần
            const month = String(today.getMonth() + 1).padStart(2, '0'); // Lấy tháng (0-indexed) và thêm số 0 nếu cần
            const year = today.getFullYear(); // Lấy năm

            return `${year}`;
        }
        // Thêm HTML trực tiếp vào
        debugger;
        const urlParams = new URLSearchParams(window.location.search);
        // Lấy giá trị của tham số 'name'
        var data = [];
        const list_id = urlParams.get('data');
        data = list_id.split(',');


        for (let i = 0; i < data.length; i++) {
            let conditionSaleOrderId = " <condition attribute = 'salesorderid' operator = 'in' >";
            conditionSaleOrderId += ["        <value>", data[i], "</value>"].join("");
            conditionSaleOrderId += "</condition>";
            let linkCustomerContact = [
                "    <link-entity name='contact' from='contactid' to='customerid' link-type='inner' alias='contact'>",
                "      <attribute name='bsd_fullname'/>",
                "      <attribute name='bsd_identitycardnumber'/>",
                "      <attribute name='bsd_passport'/>",
                "    </link-entity>"].join("");
            let linkCustomerAccount = [
                "    <link-entity name='account' from='accountid' to='customerid' link-type='inner' alias='acc'>",
                "      <attribute name='bsd_registrationcode'/>",
                "      <attribute name='bsd_name'/>",
                "    </link-entity>"].join("");
            var fetchXml = [
                "<fetch top='50'>",
                "  <entity name='salesorder'>",
                "    <attribute name='salesorderid'/>",
                "    <attribute name='bsd_confirmationamount'/>",
                "    <filter>",
                conditionSaleOrderId,
                "    </filter>",
                linkCustomerContact
                ,
                "    <link-entity name='product' from='productid' to='bsd_unitnumber' alias='product'>",
                "      <attribute name='name'/>",
                "    </link-entity>",
                "  </entity>",
                "</fetch>"
            ].join("");


            let bodys = `
                                    <div id="pf{pagenumber}" class="pf w0 h0 page" data-page-no="{pagenumber}">
                                        <div class="pc pc1 w0 h0 ">
                                            <div class="c x1 y1 w2 h2">
                                                <div class="t m0 x0 h3 y2 ff1 fs0 fc0 sc0 ls3 ws1"><b>ANH SAO COMMERCIAL DEVELOPMENT AND TRADING LIMITED LIABILITY COMPANY</b></div>
                                            </div>
                                            <div class="c x1 y3 w2 h2">
                                                <div class="t m0 x0 h4 y4 ff2 fs0 fc0 sc0 ls3 ws1"><b>CÔNG TY TNHH THƯƠNG MẠI VÀ PHÁT TRIỂN KINH DOANH ÁNH SAO</b></div>
                                            </div>
                                            <div class="c x1 y5 w2 h5">
                                                <div class="t m0 x2 h6 y6 ff1 fs1 fc0 sc0 ls3 ws1"><b>GIẤY XÁC NHẬN</b></div>
                                            </div>
                                            <div class="c x1 y7 w2 h5">
                                                <div class="t m0 x2 h7 y8 ff2 fs1 fc0 sc0 ls3"><b>CONFIRMATION</b></div>
                                            </div>
                                            <div class="c x1 y9 w2 h2">
                                                <div class="t m0 x3 h8 ya ff3 fs2 fc0 sc0 ls3 ws1">V/v: Xác nhận thanh toán tiền mua căn hộ LUMI HANOI</div>
                                            </div>
                                            <div class="c x1 yb w2 h2">
                                                <div class="t m0 x4 h9 yc ff4 fs2 fc0 sc0 ls3 ws1">Re:Confirmation on payment of LUMI HANOI Apartment</div>
                                            </div>
                                            <div class="c x1 yd w2 ha">
                                                <div class="t m0 xfix hb ye ff3 fs2 fc0 sc0 ls3 ws1">Hà Nội,  <span class="ff4 fs1">ngày {date_day} tháng {date_month} năm {date_year} </span></div>
                                            </div>
                                            <div class="c x1 yf w2 h2">
                                                <div class="t m0 x0 hc y10 ff1 fs2 fc0 sc0 ls3 ws1"><b>Công ty TNHH Thương Mại và Phát Triển Kinh Doanh Ánh Sao xác nhận: </b></div>
                                            </div>
                                            <div class="c x1 y11 w2 h2">
                                                <div class="t m0 x0 hc y12 ff2 fs2 fc0 sc0 ls3 ws1"><b>Anh Sao Commercial Development and Trading Limited Liability Company confirm:</b></div>
                                            </div>
                                            <div class="c x1 y13 w3 h2">
                                                <div class="t m0 x0 h8 y14 ff3 fs2 fc0 sc0 ls3 ws1">Tên người mua 1:</div>
                                            </div>
                                            <div class="c x6 y13 w4 h2" style="bottom:480px;height:50px !important;">
                                                <div class="t m0 x0 h9 y14 ff4 fs2 fc0 sc0 ls3 ws1"  style=";height:150px !important;"><span style="padding-bottom:20px !important;float:right;white-space:normal;width:900px;height:80px !important">{cus_name}</span></div>
                                            </div>
                                            <div class="c x1 y15 w3 h2">
                                                <div class="t m0 x0 hd y16 ff5 fs2 fc0 sc0 ls3 ws1"><i>Full name of purchaser</i></div>
                                            </div>
                                            <div class="c x1 y17 w3 h2">
                                                <div class="t m0 x0 h8 y18 ff3 fs2 fc0 sc0 ls3 ws1">Số CMND/Hộ chiếu:</div>
                                            </div>
                                            <div class="c x6 y17 w4 h2" style="bottom:430px;height:50px !important;">
                                                <div class="t m0 x0 h9 y18 ff4 fs2 fc0 sc0 ls3" style=";height:150px !important;"><span style="padding-bottom:20px !important;float:right;white-space:normal;width:900px;height:80px !important">{id_number}</span></div>
                                            </div>
                                            <div class="c x1 y19 w3 h2">
                                                <div class="t m0 x0 hd y1a ff5 fs2 fc0 sc0 ls3 ws1"><i>ID/Passport Number</i></div>
                                            </div>
                                            <div class="c x1 y1b w3 h2">
                                                <div class="t m0 x0 h8 y1c ff3 fs2 fc0 sc0 ls3 ws1">Căn hộ số:</div>
                                            </div>
                                            <div class="c x6 y1b w4 h2">
                                                <div class="t m0 x0 hc y1c ff2 fs2 fc0 sc0 ls3"><b>{unit_number}</b></div>
                                            </div>
                                            <div class="c x1 y1d w3 h2">
                                                <div class="t m0 x0 hd y1e ff5 fs2 fc0 sc0 ls3 ws1"><i>The Unit number</i></div>
                                            </div>
                                            <div class="c x1 y1f w3 he">
                                                <div class="t m0 x0 h8 y20 ff3 fs2 fc0 sc0 ls3 ws1">Tổng số tiền đã thanh toán cho các đợt thanh toán đến<span class="fc2 sc0"> </span></div>
                                                <div class="t m0 x0 h8 y21 ff3 fs2 fc0 sc0 ls3 ws1">hạn chi tiết như sau:</div>
                                                <div class="t m0 x0 h8 y22 ff6 fs2 fc0 sc0 ls3 ws1"><i>(Không bao gồm số tiền thanh toán cho lãi phạt trả </i></div>
                                                <div class="t m0 x0 h8 y23 ff6 fs2 fc0 sc0 ls3 ws1">chậm và phí quản lý)</div>
                                                <div class="t m0 x0 h9 y24 ff4 fs2 fc0 sc0 ls3 ws1">Total amount paid:</div>
                                                <div class="t m0 x0 h9 y25 ff5 fs2 fc0 sc0 ls3 ws1"><i>(Exclude paid amount for default interest)</i><span class="ff4">)</span></div>
                                            </div>
                                                <div class="c x6 y1f w4 he">
                                                    <div class="t m0 x0 hf y26 ff2 fs2 fc0 sc0 ls3 ws0"><span class="fs3 ws1" style="white-space:normal;width: 1000px;display:inline-block"> <span class="fs2"> <span class="ff6" ><b>{total_amount_paid}</b> VND <i>({string_money}.)</i></span></span></span></div>
                                                </div>
                                            <div class="c x1 y27 w3 h2">
                                                <div class="t m0 x7 h8 y28 ff3 fs2 fc0 sc0 ls3 ws1">Người lập biểu</div>
                                            </div>
                                            <div class="c x8 y27 w3 h2">
                                                <div class="t m0 x7 h8 y29 ff3 fs2 fc0 sc0 ls3 ws1">Kế toán trưởng</div>
                                            </div>
                                            <div class="c x1 y2a w3 h2">
                                                <div class="t m0 x9 h9 y2b ff4 fs2 fc0 sc0 ls3 ws1">Prepared by</div>
                                            </div>
                                            <div class="c x8 y2a w3 h2">
                                                <div class="t m0 xa h9 y2c ff4 fs2 fc0 sc0 ls3 ws1">Chief Accountant</div>
                                            </div>
<!--                                            <div class="c x1 y2d w3 ha">
                                                <div class="t m0 xb h6 y2e ff3 fs1 fc0 sc0 ls3 ws1">Nguyễn Thị Thúy</div>
                                            </div>
-->
                                            <div class="c x8 y2d w3 ha">
                                                <div class="t m0 xc h8 y2f ff3 fs2 fc0 sc0 ls3 ws1">Nguyễn Thị Thu Trang</div>
                                            </div>
                                        </div>

                                    </div>
                            `
            CrmFetchKit.Fetch(fetchXml, false).then(function (rs) {
                if (rs.length == 0) {
                    fetchXml = [
                        "<fetch >",
                        "  <entity name='salesorder'>",
                        "    <attribute name='salesorderid'/>",
                        "    <attribute name='bsd_confirmationamount'/>",
                        "    <filter>",
                        conditionSaleOrderId,
                        "    </filter>",
                        linkCustomerAccount
                        ,
                        "    <link-entity name='product' from='productid' to='bsd_unitnumber' alias='product'>",
                        "      <attribute name='name'/>",
                        "    </link-entity>",
                        "  </entity>",
                        "</fetch>"
                    ].join("");
                    CrmFetchKit.Fetch(fetchXml, false).then(function (rs2) { replaceParam(rs2, bodys, data[i]); })
                }
                else {

                    replaceParam(rs, bodys, data[i]);
                }
            })
        }
        function replaceParam(rs, content, saleorderid) {
            for (let i = 0; i < rs.length; i++) {
                var s = content;
                var item = rs[i].attributes;
                s = s.replace("{date_day}", getCurrentDateFormatted())
                s = s.replace("{date_month}", getmonth())
                s = s.replace("{date_year}", getyear())
                s = s.replace("{unit_number}", item['product.name'].value)//căn hộ số
                if (item['bsd_confirmationamount']) {
                    s = s.replace("{total_amount_paid}", formatNumberWithoutCurrencySymbol(item['bsd_confirmationamount'].value))
                    const number = parseFloat(item['bsd_confirmationamount'].value);
                    s = s.replace("{string_money}", numberToTextVN(number))
                }
                else { s = s.replace("{total_amount_paid}", 0); s = s.replace("{string_money}", "không đồng chẵn") };

                //gắn ID/Passport
                if (item['contact.bsd_identitycardnumber']) {
                    s = s.replace("{id_number}", item['contact.bsd_identitycardnumber'].value + " / {id_number}")
                } else if (item['contact.bsd_passport']) {
                    s = s.replace("{id_number}", item['contact.bsd_passport'].value + " / {id_number}")
                } else if (item['acc.bsd_registrationcode']) {
                    s = s.replace("{id_number}", item['acc.bsd_registrationcode'].value + " / {id_number}")
                }
                //Gắn tên
                if (item['contact.bsd_fullname']) {
                    s = s.replace("{cus_name}", item['contact.bsd_fullname'].value + " / {cus_name}")
                }
                else if (item['acc.bsd_name']) {
                    s = s.replace("{cus_name}", item['acc.bsd_name'].value + " / {cus_name}")
                }
                // lấy danh sách cowner gắn vô nữa
                s = s.replace("{pagenumber}", page);
                var fetchXml = [
                    "<fetch top='50'>",
                    "  <entity name='bsd_coowner'>",
                    "    <filter>",
                    "      <condition attribute='bsd_optionentry' operator='eq' value='", saleorderid, "'/>",
                    "    </filter>",
                    "    <link-entity name='contact' from='contactid' to='bsd_customer' alias='contact'>",
                    "      <attribute name='bsd_fullname'/>",
                    "      <attribute name='bsd_identitycardnumber'/>",
                    "      <attribute name='bsd_passport'/>",
                    "    </link-entity>",
                    "  </entity>",
                    "</fetch>"
                ].join("");
                CrmFetchKit.Fetch(fetchXml, false).then(function (_rs) {
                    if (_rs.length == 0) {
                        fetchXml = [
                            "<fetch top='50'>",
                            "  <entity name='bsd_coowner'>",
                            "    <filter>",
                            "      <condition attribute='bsd_optionentry' operator='eq' value='", saleorderid, "'/>",
                            "    </filter>",
                            "    <link-entity name='account' from='accountid' to='bsd_customer' alias='acc'> ",
                            "      <attribute name='bsd_registrationcode'/>",
                            "      <attribute name='bsd_name'/>",
                            "    </link-entity>",
                            "  </entity>",
                            "</fetch>"
                        ].join("");
                        CrmFetchKit.Fetch(fetchXml, false).then(function (_rs2) {
                            if (_rs2.length == 0) {
                                s = s.replace("/ {id_number}", "");
                                s = s.replace("/ {cus_name}", "");
                            }
                            else {
                                for (var j = 0; j++; j < _rs2.length) {
                                    let rsdata = _rs2[j].attributes;
                                    if (rsdata['acc.bsd_registrationcode']) {
                                        s = s.replace("{id_number}", rsdata['acc.bsd_registrationcode'].value + " / {id_number}")
                                    }
                                    //Gắn tên
                                    if (rsdata['acc.bsd_name']) {
                                        s = s.replace("{cus_name}", rsdata['acc.bsd_name'].value + " / {cus_name}")
                                    }
                                }
                                s = s.replace("/ {id_number}", "");
                                s = s.replace("/ {cus_name}", "");
                            }

                        })
                    }
                    else {
                        for (var j = 0; j < _rs.length; j++) {
                            let rsdata = _rs[j].attributes;
                            if (rsdata['contact.bsd_identitycardnumber']) {
                                s = s.replace("{id_number}", rsdata['contact.bsd_identitycardnumber'].value + " / {id_number}")
                            } else if (rsdata['contact.bsd_passport'].value) {
                                s = s.replace("{id_number}", rsdata['contact.bsd_passport'].value + " / {id_number}")
                            }
                            //Gắn tên
                            if (rsdata['contact.bsd_fullname']) {
                                s = s.replace("{cus_name}", rsdata['contact.bsd_fullname'].value + " / {cus_name}")
                            }
                        }
                        s = s.replace("/ {id_number}", "");
                        s = s.replace("/ {cus_name}", "");
                    }
                })
                document.body.insertAdjacentHTML('beforeend', s);
                page++;
            }

        }


    </script>

</body>

</html>